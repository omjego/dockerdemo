#Multi stage docker build.
#Stage 1: First run maven build and create package
#Stage 2: Copy only target folder in to new image

#FROM maven as build
#WORKDIR /usr/src/app

#COPY ./ ./  #Never do this if you're going to build inside container

COPY pom.xml /usr/src/app
RUN mvn verify --fail-never
ADD . /usr/src/app
RUN mvn clean package -DskipTests

FROM openjdk:8-jre-alpine
MAINTAINER omkar.j@media.net
RUN echo 'Building project'
EXPOSE 8080
CMD ["java", "-jar", "/usr/app.jar"]
